<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>玉里地政事務所-花蓮縣地段轄區判斷系統</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            /* 禁止選取文字 */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 flex flex-col text-gray-800">

    <!-- Header -->
    <header class="bg-teal-700 text-white py-6 shadow-md">
        <div class="container mx-auto px-4 text-center">
            <div class="flex items-center justify-center space-x-3 mb-2">
                <i data-lucide="map-pin" class="w-8 h-8 text-yellow-300"></i>
                <h1 class="text-2xl md:text-3xl font-bold tracking-wide">玉里地政事務所-花蓮縣地段轄區判斷系統</h1>
            </div>
            <p class="text-teal-100 text-sm md:text-base">
                收錄 2025 年最新地段代碼表，輸入地段或鄉鎮即可查詢
            </p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-8 max-w-2xl">
        
        <!-- Search Input -->
        <div class="bg-white p-6 rounded-2xl shadow-lg mb-8">
            <label class="block text-gray-700 text-sm font-bold mb-2 ml-1">
                請輸入地段名 (如: 三民、富源) 或 鄉鎮名 (如: 玉里)
            </label>
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i data-lucide="search" class="h-5 w-5 text-gray-400"></i>
                </div>
                <input
                    type="text"
                    id="searchInput"
                    class="block w-full pl-10 pr-3 py-4 border border-gray-300 rounded-xl leading-5 bg-gray-50 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition duration-150 ease-in-out text-lg select-text"
                    placeholder="例如：玉璞、赤科山、六十石山..."
                    style="-webkit-user-select: text; user-select: text;"
                />
            </div>
            
            <!-- Quick Tags -->
            <div class="mt-4 flex flex-wrap gap-2">
                <span class="text-xs text-gray-500 self-center mr-1">熱門查詢：</span>
                <button onclick="setSearch('玉璞')" class="px-3 py-1 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100">玉璞</button>
                <button onclick="setSearch('春日')" class="px-3 py-1 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100">春日</button>
                <button onclick="setSearch('神社')" class="px-3 py-1 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100">神社</button>
                <button onclick="setSearch('水源')" class="px-3 py-1 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100">水源</button>
                <button onclick="setSearch('玉里')" class="px-3 py-1 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100">玉里</button>
                <button onclick="setSearch('六十石山')" class="px-3 py-1 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100">六十石山</button>
            </div>
        </div>

        <!-- Results Container -->
        <div id="resultsContainer" class="hidden space-y-6 fade-in-up">
            <!-- Content will be injected here via JS -->
        </div>

        <!-- Default/No Result View -->
        <div id="defaultContainer" class="text-center py-10 fade-in-up">
            
            <!-- Suggestion Box -->
            <div id="suggestionBox" class="hidden bg-orange-50 text-orange-800 p-4 rounded-xl inline-block text-left max-w-sm border border-orange-100 shadow-sm mb-8">
                <p class="flex items-center gap-2 font-bold mb-1"><i data-lucide="info" class="w-4 h-4"></i> 提示：</p>
                <p class="text-sm" id="suggestionText"></p>
            </div>

            <div id="emptyStateIcon" class="text-gray-400">
                <i data-lucide="building-2" class="w-16 h-16 mx-auto mb-4 opacity-20"></i>
                <p>輸入上方關鍵字開始查詢</p>
            </div>
            
            <!-- Jurisdiction Reference Table -->
            <div class="mt-12 text-left">
                <h3 class="text-lg font-bold text-gray-700 mb-4 border-l-4 border-teal-500 pl-3">全縣轄區對照表 (2025 更新)</h3>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4" id="officeList">
                    <!-- Office list will be generated by JS -->
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-6 text-center text-sm">
        <p>玉里地政便民查詢系統</p>
        <p class="mt-1 text-xs">資料來源：各地政事務所 114年段別代碼表</p>
    </footer>

    <!-- JavaScript Logic -->
    <script>
        // --- 封鎖右鍵與複製 ---
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        document.addEventListener('keydown', function(e) {
            if(e.key === 'F12') e.preventDefault();
            if(e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C')) e.preventDefault();
            if(e.ctrlKey && e.key === 'U') e.preventDefault();
            if(e.ctrlKey && e.key === 'S') e.preventDefault();
        });

        // --- 資料設定 ---
        const offices = [
             {
                id: 'yuli',
                name: '玉里地政事務所',
                areas: ['玉里鎮', '瑞穗鄉', '富里鄉', '卓溪鄉'],
                address: '981 花蓮縣玉里鎮莊敬路18號',
                phone: '03-888-3171',
                mapLink: 'https://google.com/maps?q=玉里地政事務所',
                website: 'https://www.yuli.gov.tw/',
                color: 'bg-orange-600',
                lightColor: 'bg-orange-50',
                borderColor: 'border-orange-200'
            },
            {
                id: 'hualien',
                name: '花蓮地政事務所',
                areas: ['花蓮市', '吉安鄉', '新城鄉', '秀林鄉', '壽豐鄉'],
                address: '970 花蓮市府後路23號',
                phone: '03-822-5135',
                mapLink: 'https://www.google.com/maps/search/花蓮地政事務所',
                website: 'https://www.hl-land.gov.tw/',
                color: 'bg-blue-600',
                lightColor: 'bg-blue-50',
                borderColor: 'border-blue-200'
            },
            {
                id: 'fenglin',
                name: '鳳林地政事務所',
                areas: ['鳳林鎮', '光復鄉', '豐濱鄉', '萬榮鄉'],
                address: '975 花蓮縣鳳林鎮光華路1號',
                phone: '03-876-1103',
                mapLink: 'https://google.com/maps?q=鳳林地政事務所',
                website: 'https://flland.hl.gov.tw/',
                color: 'bg-green-600',
                lightColor: 'bg-green-50',
                borderColor: 'border-green-200'
            },
        ];

        // 地段資料庫
        const sectionDatabase = [
        // 花蓮市 (編號1：補0)
        { c: '0001', n: '豐村', a: '花蓮市' }, { c: '0002', n: '德興', a: '花蓮市' }, { c: '0003', n: '嘉禾', a: '花蓮市' }, { c: '0004', n: '主商', a: '花蓮市' }, 
        { c: '0005', n: '福安', a: '花蓮市' }, { c: '0006', n: '主權', a: '花蓮市' }, { c: '0007', n: '民生', a: '花蓮市' }, { c: '0008', n: '福祥', a: '花蓮市' }, 
        { c: '0009', n: '福德', a: '花蓮市' }, { c: '0010', n: '北濱', a: '花蓮市' }, { c: '0011', n: '林森', a: '花蓮市' }, { c: '0012', n: '國風', a: '花蓮市' }, 
        { c: '0013', n: '德安', a: '花蓮市' }, { c: '0014', n: '美港', a: '花蓮市' }, { c: '0015', n: '明義', a: '花蓮市' }, { c: '0016', n: '民享', a: '花蓮市' }, 
        { c: '0017', n: '富國', a: '花蓮市' }, { c: '0018', n: '民意', a: '花蓮市' }, { c: '0019', n: '民勤', a: '花蓮市' }, { c: '0020', n: '民心', a: '花蓮市' }, 
        { c: '0021', n: '樹人', a: '花蓮市' }, { c: '0022', n: '民德', a: '花蓮市' }, { c: '0023', n: '自強', a: '花蓮市' }, { c: '0024', n: '莊敬', a: '花蓮市' }, 
        { c: '0025', n: '裕民', a: '花蓮市' }, { c: '0026', n: '碧雲', a: '花蓮市' }, { c: '0027', n: '國光', a: '花蓮市' }, { c: '0028', n: '花蓮港', a: '花蓮市' }, 
        { c: '0029', n: '美崙', a: '花蓮市' }, { c: '0030', n: '民孝', a: '花蓮市' }, { c: '0031', n: '國民', a: '花蓮市' }, { c: '0032', n: '國股', a: '花蓮市' }, 
        { c: '0080', n: '國強', a: '花蓮市' }, { c: '0100', n: '國興', a: '花蓮市' }, { c: '0101', n: '慈濟', a: '花蓮市' }, { c: '0110', n: '四維', a: '花蓮市' }, 
        { c: '0111', n: '功學', a: '花蓮市' }, { c: '0112', n: '慈雲', a: '花蓮市' }, { c: '0113', n: '石壁', a: '花蓮市' }, { c: '0114', n: '國福', a: '花蓮市' },

        // 吉安鄉 (編號1：補0)
        { c: '0033', n: '吉安林', a: '吉安鄉' }, { c: '0034', n: '田浦', a: '吉安鄉' }, { c: '0035', n: '南埔', a: '吉安鄉' }, { c: '0036', n: '化仁', a: '吉安鄉' }, 
        { c: '0037', n: '廣榮', a: '吉安鄉' }, { c: '0131', n: '宜昌', a: '吉安鄉' }, { c: '0132', n: '慈安', a: '吉安鄉' }, { c: '0133', n: '仁禮', a: '吉安鄉' }, 
        { c: '0134', n: '仁義', a: '吉安鄉' }, { c: '0135', n: '宜安', a: '吉安鄉' }, { c: '0136', n: '宜寧', a: '吉安鄉' }, { c: '0137', n: '仁廉', a: '吉安鄉' }, 
        { c: '0138', n: '仁恥', a: '吉安鄉' }, { c: '0139', n: '太昌', a: '吉安鄉' }, { c: '0140', n: '慶豐', a: '吉安鄉' }, { c: '0141', n: '福興', a: '吉安鄉' }, 
        { c: '0142', n: '稻香', a: '吉安鄉' }, { c: '0143', n: '慈勝', a: '吉安鄉' }, { c: '0144', n: '慈惠', a: '吉安鄉' }, { c: '0145', n: '吉興', a: '吉安鄉' }, 
        { c: '0146', n: '稻園', a: '吉安鄉' }, { c: '0147', n: '光華', a: '吉安鄉' }, { c: '0148', n: '永安', a: '吉安鄉' }, { c: '0149', n: '永興', a: '吉安鄉' }, 
        { c: '0150', n: '福吉', a: '吉安鄉' }, { c: '0151', n: '福南', a: '吉安鄉' }, { c: '0152', n: '華興', a: '吉安鄉' }, { c: '0153', n: '南華', a: '吉安鄉' }, 
        { c: '0154', n: '草芬', a: '吉安鄉' }, { c: '0155', n: '干城', a: '吉安鄉' }, { c: '0156', n: '廣賢', a: '吉安鄉' }, { c: '0081', n: '東昌', a: '吉安鄉' }, 
        { c: '0081', n: '光中', a: '吉安鄉' }, { c: '0084', n: '仁和', a: '吉安鄉' }, { c: '0084', n: '仁愛', a: '吉安鄉' }, { c: '0084', n: '光明', a: '吉安鄉' }, 
        { c: '0171', n: '初音', a: '吉安鄉' }, { c: '0172', n: '志平', a: '吉安鄉' }, { c: '0173', n: '東華', a: '吉安鄉' }, { c: '0174', n: '平和', a: '吉安鄉' },

        // 壽豐鄉 (編號1：補0)
        { c: '0044', n: '壽豐', a: '壽豐鄉' }, { c: '0045', n: '豐田', a: '壽豐鄉' }, { c: '0046', n: '志學', a: '壽豐鄉' }, { c: '0047', n: '治平', a: '壽豐鄉' }, 
        { c: '0048', n: '月眉', a: '壽豐鄉' }, { c: '0049', n: '水建', a: '壽豐鄉' }, { c: '0157', n: '豐坪', a: '壽豐鄉' }, { c: '0158', n: '豐山', a: '壽豐鄉' }, 
        { c: '0159', n: '鹽寮', a: '壽豐鄉' }, { c: '0160', n: '共和', a: '壽豐鄉' }, { c: '0161', n: '沼田', a: '壽豐鄉' }, { c: '0162', n: '樹林', a: '壽豐鄉' }, 
        { c: '0163', n: '芳寮', a: '壽豐鄉' }, { c: '0164', n: '壽月', a: '壽豐鄉' }, { c: '0165', n: '潭北', a: '壽豐鄉' }, { c: '0166', n: '池南', a: '壽豐鄉' }, 
        { c: '0167', n: '荖溪', a: '壽豐鄉' }, { c: '0168', n: '山嶺', a: '壽豐鄉' }, { c: '0169', n: '牛山', a: '壽豐鄉' }, { c: '0170', n: '溪口', a: '壽豐鄉' }, 
        { c: '0452', n: '米棧', a: '壽豐鄉' }, { c: '0170', n: '鯉魚潭', a: '壽豐鄉' }, { c: '0171', n: '溪南', a: '壽豐鄉' }, { c: '0451', n: '水源', a: '壽豐鄉' }, 
        { c: '0453', n: '壽農', a: '壽豐鄉' }, { c: '0454', n: '豐里', a: '壽豐鄉' }, { c: '0455', n: '壽山', a: '壽豐鄉' }, { c: '0456', n: '豐東', a: '壽豐鄉' },

        // 新城鄉 (編號1：補0)
        { c: '0050', n: '新城', a: '新城鄉' }, { c: '0051', n: '北埔', a: '新城鄉' }, { c: '0052', n: '加禮', a: '新城鄉' }, { c: '0053', n: '平野', a: '新城鄉' }, 
        { c: '0054', n: '中正', a: '新城鄉' }, { c: '0175', n: '嘉平', a: '新城鄉' }, { c: '0176', n: '嘉新', a: '新城鄉' }, { c: '0177', n: '崇德', a: '新城鄉' }, 
        { c: '0178', n: '嘉北', a: '新城鄉' }, { c: '0179', n: '佳林', a: '新城鄉' }, { c: '0180', n: '合歡', a: '新城鄉' }, { c: '0181', n: '景美', a: '新城鄉' }, 
        { c: '0182', n: '三棧', a: '新城鄉' }, { c: '0425', n: '天祥', a: '新城鄉' }, { c: '0184', n: '順安', a: '新城鄉' }, { c: '0185', n: '佳民', a: '新城鄉' }, 
        { c: '0186', n: '新興', a: '新城鄉' }, { c: '0187', n: '康樂', a: '新城鄉' }, { c: '0188', n: '大漢', a: '新城鄉' }, { c: '0189', n: '佳山', a: '新城鄉' },

        // 秀林鄉 (編號1：補0)
        { c: '0190', n: '秀林', a: '秀林鄉' }, { c: '0191', n: '富世', a: '秀林鄉' }, { c: '0192', n: '和平', a: '秀林鄉' }, { c: '0193', n: '洛韶', a: '秀林鄉' }, 
        { c: '0194', n: '慈恩', a: '秀林鄉' }, { c: '0195', n: '嘉南', a: '秀林鄉' }, { c: '0196', n: '清水', a: '秀林鄉' }, { c: '0197', n: '東升', a: '秀林鄉' }, 
        { c: '0198', n: '榕樹', a: '秀林鄉' }, { c: '0199', n: '銅門', a: '秀林鄉' }, { c: '0421', n: '文蘭', a: '秀林鄉' }, { c: '0422', n: '重光', a: '秀林鄉' }, 
        { c: '0423', n: '水源', a: '秀林鄉' }, { c: '0424', n: '關原', a: '秀林鄉' }, { c: '0426', n: '松雪樓', a: '秀林鄉' }, { c: '0425', n: '天祥', a: '秀林鄉' }, 
        { c: '0427', n: '西寶', a: '秀林鄉' },

        // 鳳林鎮 (編號2：補0)
        { c: '0205', n: '鳳林', a: '鳳林鎮' }, { c: '0213', n: '林田', a: '鳳林鎮' }, { c: '0207', n: '山興', a: '鳳林鎮' }, { c: '0208', n: '萬里橋', a: '鳳林鎮' }, 
        { c: '0209', n: '榮東', a: '鳳林鎮' }, { c: '0210', n: '榮花', a: '鳳林鎮' }, { c: '0211', n: '榮發', a: '鳳林鎮' }, { c: '0225', n: '鳳仁', a: '鳳林鎮' }, 
        { c: '0226', n: '鳳光', a: '鳳林鎮' }, { c: '0227', n: '鳳明', a: '鳳林鎮' }, { c: '0228', n: '榮開', a: '鳳林鎮' }, { c: '0229', n: '榮昌', a: '鳳林鎮' }, 
        { c: '0235', n: '石門', a: '鳳林鎮' }, { c: '0249', n: '長橋', a: '鳳林鎮' }, { c: '0250', n: '中心埔', a: '鳳林鎮' }, { c: '0251', n: '中興', a: '鳳林鎮' }, 
        { c: '0252', n: '箭瑛', a: '鳳林鎮' }, { c: '0253', n: '兆豐', a: '鳳林鎮' }, { c: '0238', n: '森榮', a: '鳳林鎮' },

        // 光復鄉 (編號2：補0)
        { c: '0200', n: '光復', a: '光復鄉' }, { c: '0206', n: '大安', a: '光復鄉' }, { c: '0202', n: '大平', a: '光復鄉' }, { c: '0203', n: '大富', a: '光復鄉' }, 
        { c: '0204', n: '富田', a: '光復鄉' }, { c: '0239', n: '東富', a: '光復鄉' }, { c: '0211', n: '太巴塱', a: '光復鄉' }, { c: '0241', n: '溪州', a: '光復鄉' }, 
        { c: '0243', n: '砂荖', a: '光復鄉' }, { c: '0244', n: '西富', a: '光復鄉' }, { c: '0245', n: '馬佛', a: '光復鄉' }, { c: '0246', n: '林榮', a: '光復鄉' }, 
        { c: '0246', n: '大榮', a: '光復鄉' }, { c: '0248', n: '鳳信', a: '光復鄉' }, { c: '0248', n: '南平', a: '光復鄉' }, { c: '0246', n: '大馬', a: '光復鄉' }, 
        { c: '0282', n: '大全', a: '光復鄉' }, { c: '0283', n: '大豐', a: '光復鄉' }, { c: '0284', n: '大和', a: '光復鄉' }, { c: '0285', n: '大興', a: '光復鄉' }, 
        { c: '0286', n: '富豐', a: '光復鄉' }, { c: '0287', n: '加里洞', a: '光復鄉' }, { c: '0288', n: '大農', a: '光復鄉' },

        // 豐濱鄉 (編號2：補0)
        { c: '0212', n: '豐濱', a: '豐濱鄉' }, { c: '0213', n: '新社', a: '豐濱鄉' }, { c: '0214', n: '臨海', a: '豐濱鄉' }, { c: '0215', n: '海濱', a: '豐濱鄉' }, 
        { c: '0216', n: '石梯', a: '豐濱鄉' }, { c: '0217', n: '大港口', a: '豐濱鄉' }, { c: '0218', n: '靜浦', a: '豐濱鄉' }, { c: '0231', n: '新豐', a: '豐濱鄉' }, 
        { c: '0232', n: '東興', a: '豐濱鄉' }, { c: '0233', n: '豐義', a: '豐濱鄉' }, { c: '0237', n: '磯崎', a: '豐濱鄉' }, { c: '0265', n: '八里灣', a: '豐濱鄉' },

        // 萬榮鄉 (編號2：補0)
        { c: '0219', n: '萬榮', a: '萬榮鄉' }, { c: '0220', n: '西林', a: '萬榮鄉' }, { c: '0221', n: '見晴', a: '萬榮鄉' }, { c: '0222', n: '明利', a: '萬榮鄉' }, 
        { c: '0223', n: '馬遠', a: '萬榮鄉' }, { c: '0224', n: '紅葉', a: '萬榮鄉' }, { c: '0259', n: '萬安', a: '萬榮鄉' }, { c: '0259', n: '馬太鞍', a: '萬榮鄉' }, 
        { c: '0220', n: '支亞干', a: '萬榮鄉' },

        // 玉里鎮 (編號3：維持4碼)
        { c: '0306', n: '玉里', a: '玉里鎮' }, { c: '0300', n: '三民', a: '玉里鎮' }, { c: '0301', n: '大禹', a: '玉里鎮' }, { c: '0302', n: '玉昌', a: '玉里鎮' }, 
        { c: '0303', n: '玉璞', a: '玉里鎮' }, { c: '0304', n: '玉城', a: '玉里鎮' }, { c: '0305', n: '玉泉', a: '玉里鎮' }, { c: '0307', n: '春日', a: '玉里鎮' }, 
        { c: '0308', n: '觀音山', a: '玉里鎮' }, { c: '0309', n: '樂合', a: '玉里鎮' }, { c: '0310', n: '長良', a: '玉里鎮' }, { c: '0312', n: '源城', a: '玉里鎮' }, 
        { c: '0339', n: '三義', a: '玉里鎮' }, { c: '0347', n: '東豐', a: '玉里鎮' }, { c: '0348', n: '禹東', a: '玉里鎮' }, { c: '0350', n: '松浦', a: '玉里鎮' }, 
        { c: '0351', n: '禹北', a: '玉里鎮' }, { c: '0353', n: '大山', a: '玉里鎮' }, { c: '0354', n: '玉東', a: '玉里鎮' }, { c: '0355', n: '酸柑', a: '玉里鎮' }, 
        { c: '0356', n: '禹中', a: '玉里鎮' }, { c: '0357', n: '禹西', a: '玉里鎮' }, { c: '0358', n: '民北', a: '玉里鎮' }, { c: '0359', n: '民南', a: '玉里鎮' }, 
        { c: '0360', n: '永良', a: '玉里鎮' }, { c: '0363', n: '赤科山', a: '玉里鎮' }, { c: '0364', n: '石崗山', a: '玉里鎮' }, { c: '0365', n: '安通山', a: '玉里鎮' }, 
        { c: '0366', n: '德武', a: '玉里鎮' }, { c: '0367', n: '神農', a: '玉里鎮' }, { c: '0368', n: '泰林', a: '玉里鎮' }, { c: '0369', n: '高寮', a: '玉里鎮' }, 
        { c: '0303', n: '玉珠', a: '玉里鎮' }, { c: '0375', n: '哈拉灣', a: '玉里鎮' }, { c: '0376', n: '安坐', a: '玉里鎮' }, { c: '0377', n: '宮前', a: '玉里鎮' }, 
        { c: '0379', n: '神社', a: '玉里鎮' }, { c: '0381', n: '舊田', a: '玉里鎮' }, { c: '0380', n: '水源', a: '玉里鎮' },

        // 瑞穗鄉 (編號3：維持4碼)
        { c: '0700', n: '瑞穗', a: '瑞穗鄉' }, { c: '0701', n: '富源', a: '瑞穗鄉' }, { c: '0702', n: '富興', a: '瑞穗鄉' }, { c: '0703', n: '鶴岡', a: '瑞穗鄉' }, 
        { c: '0704', n: '舞鶴', a: '瑞穗鄉' }, { c: '0705', n: '奇美', a: '瑞穗鄉' }, { c: '0730', n: '瑞燕', a: '瑞穗鄉' }, { c: '0731', n: '瑞美', a: '瑞穗鄉' }, 
        { c: '0732', n: '瑞泉', a: '瑞穗鄉' }, { c: '0733', n: '瑞新', a: '瑞穗鄉' }, { c: '0734', n: '瑞良', a: '瑞穗鄉' }, { c: '0735', n: '瑞強', a: '瑞穗鄉' }, 
        { c: '0742', n: '掃叭頂', a: '瑞穗鄉' }, { c: '0743', n: '大奇山', a: '瑞穗鄉' }, { c: '0744', n: '瑞北', a: '瑞穗鄉' }, { c: '0745', n: '瑞祥', a: '瑞穗鄉' }, 
        { c: '0746', n: '溫泉', a: '瑞穗鄉' }, { c: '0747', n: '青蓮', a: '瑞穗鄉' }, { c: '0748', n: '梧繞', a: '瑞穗鄉' },

        // 富里鄉 (編號3：維持4碼)
        { c: '0715', n: '富里', a: '富里鄉' }, { c: '0716', n: '大里', a: '富里鄉' }, { c: '0717', n: '東竹', a: '富里鄉' }, { c: '0755', n: '公埔', a: '富里鄉' }, 
        { c: '0756', n: '太平', a: '富里鄉' }, { c: '0757', n: '明里', a: '富里鄉' }, { c: '0758', n: '石牌', a: '富里鄉' }, { c: '0759', n: '中興', a: '富里鄉' }, 
        { c: '0760', n: '中平', a: '富里鄉' }, { c: '0761', n: '富安', a: '富里鄉' }, { c: '0762', n: '安通', a: '富里鄉' }, { c: '0763', n: '富農', a: '富里鄉' }, 
        { c: '0764', n: '吳江', a: '富里鄉' }, { c: '0765', n: '大庄', a: '富里鄉' }, { c: '0766', n: '東里', a: '富里鄉' }, { c: '0767', n: '農場', a: '富里鄉' }, 
        { c: '0768', n: '萬寧', a: '富里鄉' }, { c: '0769', n: '學園', a: '富里鄉' }, { c: '0770', n: '竹田', a: '富里鄉' }, { c: '0771', n: '學田', a: '富里鄉' }, 
        { c: '0772', n: '永豐', a: '富里鄉' }, { c: '0773', n: '豐南', a: '富里鄉' }, { c: '0774', n: '姆拉丁', a: '富里鄉' }, { c: '0775', n: '羅山', a: '富里鄉' },
        { c: '0776', n: '鱉溪', a: '富里鄉' }, { c: '0777', n: '吉拉米代', a: '富里鄉' }, { c: '0778', n: '泥火山', a: '富里鄉' }, { c: '0788', n: '六十石山', a: '富里鄉' },

        // 卓溪鄉 (編號3：維持4碼)
        { c: '0783', n: '卓溪', a: '卓溪鄉' }, { c: '0779', n: '崙山', a: '卓溪鄉' }, { c: '0780', n: '立山', a: '卓溪鄉' }, { c: '0781', n: '山里', a: '卓溪鄉' }, 
        { c: '0782', n: '太平', a: '卓溪鄉' }, { c: '0784', n: '卓樂', a: '卓溪鄉' }, { c: '0785', n: '清水', a: '卓溪鄉' }, { c: '0786', n: '古風', a: '卓溪鄉' }, 
        { c: '0787', n: '石平', a: '卓溪鄉' }, { c: '0788', n: '新生', a: '卓溪鄉' }, { c: '0789', n: '鹿鳴', a: '卓溪鄉' }, { c: '0799', n: '瓦拉米', a: '卓溪鄉' }, 
        { c: '0820', n: '南安', a: '卓溪鄉' }, { c: '0828', n: '崙天', a: '卓溪鄉' }, { c: '0827', n: '白端', a: '卓溪鄉' }
    ];
        

        // --- DOM 元素 ---
        const searchInput = document.getElementById('searchInput');
        const resultsContainer = document.getElementById('resultsContainer');
        const defaultContainer = document.getElementById('defaultContainer');
        const suggestionBox = document.getElementById('suggestionBox');
        const suggestionText = document.getElementById('suggestionText');
        const officeListContainer = document.getElementById('officeList');
        const emptyStateIcon = document.getElementById('emptyStateIcon');

        // --- 初始化頁面 ---
        window.addEventListener('DOMContentLoaded', () => {
            renderOfficeList();
            lucide.createIcons();
            searchInput.addEventListener('input', handleSearch);
        });

        // 搜尋處理邏輯 (已修改為即時篩選)
        function handleSearch(e) {
            const rawTerm = e.target.value;
            const term = rawTerm.trim().replace('台', '臺');
            
            if (!term) {
                showDefaultView();
                return;
            }

            let results = [];

            // 1. 檢查行政區 (模糊包含)
            const officeMatches = offices.filter(office => 
                office.areas.some(area => area.includes(term))
            );

            if (officeMatches.length > 0) {
                officeMatches.forEach(office => {
                    const matchedArea = office.areas.find(area => area.includes(term));
                    results.push({
                        office: office,
                        matchType: 'area',
                        matchName: matchedArea
                    });
                });
            }

            // 2. 檢查地段名 (即時篩選包含字樣的結果)
            const sectionMatches = sectionDatabase.filter(s => 
                s.n.includes(term) || (s.n + '段').includes(term)
            );

            if (sectionMatches.length > 0) {
                sectionMatches.forEach(match => {
                    const office = offices.find(o => o.areas.includes(match.a));
                    if (office) {
                        // 避免重複加入
                        const isDuplicate = results.some(r => r.matchType === 'section' && r.matchName === match.n + '段' && r.relatedArea === match.a);
                        if (!isDuplicate) {
                            results.push({
                                office: office,
                                matchType: 'section',
                                matchName: match.n + '段',
                                relatedArea: match.a
                            });
                        }
                    }
                });
            }

            // 3. 顯示結果
            if (results.length > 0) {
                renderResults(results);
            } else {
                showDefaultView();
                showSuggestion('查無此地段或行政區。建議輸入「鄉鎮市名稱」(如：吉安、瑞穗) 查詢最為準確。或是您的地段名稱較為特殊，請嘗試輸入前兩個字。');
            }
        }

        // 設置快速搜尋
        function setSearch(val) {
            searchInput.value = val;
            handleSearch({ target: { value: val } });
        }

        // 渲染結果卡片
        function renderResults(results) {
            resultsContainer.classList.remove('hidden');
            defaultContainer.classList.add('hidden');
            resultsContainer.innerHTML = '';

            // 多筆結果提示 (當搜尋結果較多時提醒使用者)
            if (results.length > 1) {
                const alertHtml = `
                    <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded mb-4">
                        <div class="flex">
                            <i data-lucide="alert-triangle" class="h-5 w-5 text-yellow-600 mr-2"></i>
                            <p class="text-sm text-yellow-700">
                                找到 <strong>${results.length}</strong> 筆可能符合的資料。請依據您的土地位於哪個鄉鎮來判斷。
                            </p>
                        </div>
                    </div>
                `;
                resultsContainer.innerHTML += alertHtml;
            }

            results.forEach(result => {
                const card = document.createElement('div');
                card.className = "shadow-xl rounded-2xl overflow-hidden bg-white mb-6";
                
                let matchContent = '';
                if (result.matchType === 'area') {
                    matchContent = `您查詢的行政區為 <strong class="text-lg">${result.matchName}</strong>`;
                } else {
                    matchContent = `您查詢的地段 <strong class="text-lg">${result.matchName}</strong> 位於 <strong class="text-lg text-teal-700">${result.relatedArea}</strong>`;
                }

                const areasHtml = result.office.areas.map(area => {
                    const isHighlight = area === result.matchName || area === result.relatedArea;
                    const classes = isHighlight 
                        ? 'bg-yellow-200 text-yellow-800 font-bold ring-1 ring-yellow-300' 
                        : 'text-gray-600 bg-gray-100';
                    return `<span class="text-xs px-2 py-1 rounded ${classes}">${area}</span>`;
                }).join('');

                card.innerHTML = `
                    <div class="p-4 text-white ${result.office.color} flex justify-between items-center">
                        <div>
                            <span class="text-xs uppercase tracking-wider opacity-90 font-semibold">管轄單位</span>
                            <h2 class="text-2xl font-bold">${result.office.name}</h2>
                        </div>
                        <i data-lucide="building-2" class="w-10 h-10 opacity-80"></i>
                    </div>
                    
                    <div class="bg-white border-x border-b border-gray-100">
                        <div class="p-6">
                            <div class="mb-6 ${result.office.lightColor} border-l-4 ${result.office.borderColor} p-4 rounded-r">
                                <div class="flex">
                                    <div class="flex-shrink-0">
                                        <i data-lucide="info" class="h-5 w-5 text-gray-600"></i>
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-gray-800">${matchContent}</p>
                                    </div>
                                </div>
                            </div>

                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                <div class="flex items-start">
                                    <i data-lucide="map-pin" class="w-5 h-5 text-gray-400 mt-1 mr-3"></i>
                                    <div>
                                        <p class="text-xs text-gray-500">地址</p>
                                        <p class="text-gray-800 font-medium">${result.office.address}</p>
                                    </div>
                                </div>
                                <div class="flex items-start">
                                    <i data-lucide="phone" class="w-5 h-5 text-gray-400 mt-1 mr-3"></i>
                                    <div>
                                        <p class="text-xs text-gray-500">電話</p>
                                        <a href="tel:${result.office.phone}" class="text-teal-600 font-medium hover:underline font-mono text-lg">${result.office.phone}</a>
                                    </div>
                                </div>
                            </div>

                            <div class="flex items-start mb-6">
                                <i data-lucide="building-2" class="w-5 h-5 text-gray-400 mt-1 mr-3"></i>
                                <div>
                                    <p class="text-xs text-gray-500">該所完整轄區</p>
                                    <div class="flex flex-wrap gap-1 mt-1">${areasHtml}</div>
                                </div>
                            </div>

                            <div class="flex gap-3">
                                <a href="${result.office.mapLink}" target="_blank" class="flex-1 bg-teal-600 text-white py-3 px-4 rounded-xl text-center font-medium hover:bg-teal-700 transition flex items-center justify-center gap-2">
                                    <i data-lucide="navigation" class="w-4 h-4"></i> 導航前往
                                </a>
                                <a href="${result.office.website}" target="_blank" class="flex-1 bg-white border border-gray-300 text-gray-700 py-3 px-4 rounded-xl text-center font-medium hover:bg-gray-50 transition flex items-center justify-center gap-2">
                                    <i data-lucide="external-link" class="w-4 h-4"></i> 官方網站
                                </a>
                            </div>
                        </div>
                    </div>
                `;
                resultsContainer.appendChild(card);
            });
            lucide.createIcons();
        }

        function showDefaultView() {
            resultsContainer.classList.add('hidden');
            defaultContainer.classList.remove('hidden');
            suggestionBox.classList.add('hidden');
            emptyStateIcon.classList.remove('hidden');
        }

        function showSuggestion(msg) {
            suggestionText.textContent = msg;
            suggestionBox.classList.remove('hidden');
            emptyStateIcon.classList.add('hidden');
        }

        function renderOfficeList() {
            officeListContainer.innerHTML = offices.map(office => `
                <div class="bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition">
                    <div class="text-xs font-bold px-2 py-1 text-white rounded w-fit mb-2 ${office.color}">
                        ${office.name}
                    </div>
                    <ul class="text-sm text-gray-600 space-y-1 pl-1">
                        ${office.areas.map(area => `
                            <li class="flex items-center">
                                <span class="w-1.5 h-1.5 rounded-full bg-gray-300 mr-2"></span>
                                ${area}
                            </li>
                        `).join('')}
                    </ul>
                </div>
            `).join('');
        }

        window.setSearch = setSearch;
    </script>
</body>
</html>
