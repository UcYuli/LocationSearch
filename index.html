<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>玉里地政事務所-花蓮縣地段轄區判斷系統</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            /* 禁止選取文字 (除了輸入框) */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            touch-action: manipulation;
        }
        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        /* 避免行動端輸入框自動放大 */
        input[type="text"] {
            font-size: 16px !important;
        }
        @media (min-width: 768px) {
            input[type="text"] {
                font-size: 1.125rem !important;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50 flex flex-col text-gray-800 overflow-x-hidden">

    <!-- Header -->
    <header class="bg-teal-700 text-white py-6 md:py-8 shadow-md">
        <div class="container mx-auto px-4 text-center">
            
            <!-- 重新設計的標題區塊 -->
            <!-- 行動端版本：垂直排列，優化斷行與比例 -->
            <div class="md:hidden flex flex-col items-center gap-3 mb-4">
                <i data-lucide="map-pin" class="w-12 h-12 text-yellow-300"></i>
                <h1 class="text-xl font-bold tracking-tight leading-snug">
                    玉里地政事務所<br>花蓮縣地段轄區判斷系統
                </h1>
            </div>

            <!-- PC 桌面端版本：橫向排列，維持 32 吋螢幕協調度 -->
            <div class="hidden md:flex items-center justify-center gap-4 mb-4">
                <i data-lucide="map-pin" class="w-8 h-8 text-yellow-300 shrink-0"></i>
                <h1 class="text-3xl font-bold tracking-wide">
                    玉里地政事務所-花蓮縣地段轄區判斷系統
                </h1>
            </div>

            <!-- 副標題區塊 -->
            <p class="text-teal-100 text-[11px] xs:text-xs md:text-base px-1 md:px-2 leading-relaxed opacity-90 max-w-2xl mx-auto">
                收錄 2026 年最新地段代碼表，輸入
				<span class="text-red-300 font-bold border-b border-red-300/30"> ＂部分＂ </span>
				<span class="text-yellow-300 font-bold border-b border-yellow-300/30">地段名</span>、
				<span class="text-yellow-300 font-bold border-b border-yellow-300/30">鄉鎮</span>或
				<span class="text-yellow-300 font-bold border-b border-yellow-300/30">地段號</span>
                <span class="whitespace-nowrap">即可查詢</span>
            </p>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow container mx-auto px-4 py-6 md:py-10 max-w-3xl">
        
        <!-- Search Input Section -->
        <div class="bg-white p-5 md:p-8 rounded-2xl shadow-lg mb-6 md:mb-10">
            <label class="block text-gray-700 text-sm font-bold mb-3 ml-1">
                請輸入地段名、鄉鎮名 或 地段號
            </label>
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none">
                    <i data-lucide="search" class="h-5 w-5 text-gray-400"></i>
                </div>
                <input
                    type="text"
                    id="searchInput"
                    class="block w-full pl-12 pr-4 py-3 md:py-4 border border-gray-300 rounded-xl leading-5 bg-gray-50 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-teal-500 focus:border-teal-500 transition duration-150 ease-in-out select-text"
                    placeholder="輸入地段、代碼或鄉鎮..."
                    style="-webkit-user-select: text; user-select: text;"
                />
            </div>
            
            <!-- Quick Tags (Scrollable on small screens) -->
            <div class="mt-4">
                <div class="flex items-center text-xs text-gray-500 mb-2">
                    <i data-lucide="help-circle" class="w-3 h-3 mr-1"></i> 查詢範例：
                </div>
                <div class="flex flex-wrap gap-2 overflow-x-auto pb-1">
                    <button onclick="setSearch('玉璞')" class="whitespace-nowrap px-3 py-1.5 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100 active:scale-95">玉璞</button>
                    <button onclick="setSearch('0303')" class="whitespace-nowrap px-3 py-1.5 bg-orange-50 text-orange-700 rounded-full text-xs hover:bg-orange-100 transition border border-orange-100 active:scale-95">代碼 0303</button>
                    <button onclick="setSearch('春日')" class="whitespace-nowrap px-3 py-1.5 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100 active:scale-95">春日</button>
                    <button onclick="setSearch('0701')" class="whitespace-nowrap px-3 py-1.5 bg-orange-50 text-orange-700 rounded-full text-xs hover:bg-orange-100 transition border border-orange-100 active:scale-95">代碼 0701</button>
                    <button onclick="setSearch('神社')" class="whitespace-nowrap px-3 py-1.5 bg-teal-50 text-teal-700 rounded-full text-xs hover:bg-teal-100 transition border border-teal-100 active:scale-95">神社</button>
                    <button onclick="setSearch('0802')" class="whitespace-nowrap px-3 py-1.5 bg-orange-50 text-orange-700 rounded-full text-xs hover:bg-orange-100 transition border border-orange-100 active:scale-95">代碼 0802</button>
                </div>
            </div>
        </div>

        <!-- Results Container -->
        <div id="resultsContainer" class="hidden space-y-6 fade-in-up">
            <!-- Content will be injected here via JS -->
        </div>

        <!-- Default View -->
        <div id="defaultContainer" class="text-center py-6 md:py-10 fade-in-up">
            
            <div id="suggestionBox" class="hidden bg-orange-50 text-orange-800 p-4 rounded-xl inline-block text-left w-full max-w-sm border border-orange-100 shadow-sm mb-8 mx-auto">
                <p class="flex items-center gap-2 font-bold mb-1"><i data-lucide="info" class="w-4 h-4"></i> 提示：</p>
                <p class="text-sm" id="suggestionText"></p>
            </div>

            <div id="emptyStateIcon" class="text-gray-400">
                <i data-lucide="building-2" class="w-12 h-12 md:w-16 md:h-16 mx-auto mb-4 opacity-20"></i>
                <p class="text-sm md:text-base">輸入地段名或代碼開始查詢</p>
            </div>
            
            <!-- Jurisdiction Reference Table -->
            <div class="mt-12 text-left">
                <h3 class="text-lg font-bold text-gray-700 mb-6 border-l-4 border-teal-500 pl-3">全縣轄區對照表 (2025 更新)</h3>
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4" id="officeList">
                    <!-- Office list will be generated by JS -->
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-8 px-4 text-center text-sm mt-auto">
        <p class="font-medium">玉里地政便民查詢系統</p>
        <p class="mt-2 text-xs opacity-60">資料來源：各地政事務所 114 年段別代碼表</p>
    </footer>

    <script>
        // --- 封鎖右鍵與開發者工具 ---
        document.addEventListener('contextmenu', e => e.preventDefault());
        document.addEventListener('keydown', e => {
            if(e.key === 'F12' || (e.ctrlKey && e.shiftKey && ['I','J','C'].includes(e.key)) || (e.ctrlKey && ['U','S'].includes(e.key))) e.preventDefault();
        });

        // --- 資料設定 ---
        const offices = [
            {
                id: 'yuli',
                name: '玉里地政事務所',
                areas: ['玉里鎮', '瑞穗鄉', '富里鄉', '卓溪鄉'],
                address: '花蓮縣玉里鎮莊敬路18號',
                phone: '03-888-3171',
                mapLink: 'https://google.com/maps?q=玉里地政事務所',
                website: 'https://www.yuli.gov.tw/',
                color: 'bg-orange-600',
                lightColor: 'bg-orange-50',
                borderColor: 'border-orange-200'
            },
            {
                id: 'hualien',
                name: '花蓮地政事務所',
                areas: ['花蓮市', '吉安鄉', '新城鄉', '秀林鄉', '壽豐鄉'],
                address: '花蓮市府後路23號',
                phone: '03-822-5135',
                mapLink: 'https://www.google.com/maps/search/花蓮地政事務所',
                website: 'https://www.hl-land.gov.tw/',
                color: 'bg-blue-600',
                lightColor: 'bg-blue-50',
                borderColor: 'border-blue-200'
            },
            {
                id: 'fenglin',
                name: '鳳林地政事務所',
                areas: ['鳳林鎮', '光復鄉', '豐濱鄉', '萬榮鄉'],
                address: '花蓮縣鳳林鎮光華路1號',
                phone: '03-876-1103',
                mapLink: 'https://google.com/maps?q=鳳林地政事務所',
                website: 'https://flland.hl.gov.tw/',
                color: 'bg-green-600',
                lightColor: 'bg-green-50',
                borderColor: 'border-green-200'
            },
        ];

        // 範例資料庫
        const sectionDatabase = [// 花蓮市
			  { "c": "0001", "n": "豐村", "a": "花蓮市" }, { "c": "0002", "n": "德興", "a": "花蓮市" }, { "c": "0003", "n": "嘉禾", "a": "花蓮市" }, { "c": "0004", "n": "主商", "a": "花蓮市" },
			  { "c": "0005", "n": "福安", "a": "花蓮市" }, { "c": "0006", "n": "主權", "a": "花蓮市" }, { "c": "0007", "n": "民生", "a": "花蓮市" }, { "c": "0008", "n": "福祥", "a": "花蓮市" },
			  { "c": "0009", "n": "福德", "a": "花蓮市" }, { "c": "0010", "n": "北濱", "a": "花蓮市" }, { "c": "0011", "n": "林森", "a": "花蓮市" }, { "c": "0012", "n": "國風", "a": "花蓮市" },
			  { "c": "0013", "n": "德安", "a": "花蓮市" }, { "c": "0014", "n": "美港", "a": "花蓮市" }, { "c": "0015", "n": "明義", "a": "花蓮市" }, { "c": "0016", "n": "民享", "a": "花蓮市" },
			  { "c": "0017", "n": "富國", "a": "花蓮市" }, { "c": "0018", "n": "民意", "a": "花蓮市" }, { "c": "0019", "n": "民勤", "a": "花蓮市" }, { "c": "0020", "n": "民心", "a": "花蓮市" },
			  { "c": "0021", "n": "樹人", "a": "花蓮市" }, { "c": "0022", "n": "民德", "a": "花蓮市" }, { "c": "0023", "n": "自強", "a": "花蓮市" }, { "c": "0024", "n": "莊敬", "a": "花蓮市" },
			  { "c": "0025", "n": "裕民", "a": "花蓮市" }, { "c": "0081", "n": "碧雲", "a": "花蓮市" }, { "c": "0082", "n": "國光", "a": "花蓮市" }, { "c": "0083", "n": "花蓮港", "a": "花蓮市" },
			  { "c": "0084", "n": "美崙", "a": "花蓮市" }, { "c": "0095", "n": "民孝", "a": "花蓮市" }, { "c": "0097", "n": "國民", "a": "花蓮市" }, { "c": "0098", "n": "國股", "a": "花蓮市" },
			  { "c": "0099", "n": "國強", "a": "花蓮市" }, { "c": "0100", "n": "國興", "a": "花蓮市" }, { "c": "0101", "n": "慈濟", "a": "花蓮市" }, { "c": "0110", "n": "四維", "a": "花蓮市" },
			  { "c": "0111", "n": "功學", "a": "花蓮市" }, { "c": "0112", "n": "慈雲", "a": "花蓮市" }, { "c": "0113", "n": "石壁", "a": "花蓮市" }, { "c": "0114", "n": "國福", "a": "花蓮市" },
			  { "c": "0457", "n": "佐倉", "a": "花蓮市" }, { "c": "0458", "n": "娑婆噹", "a": "花蓮市" }, { "c": "0494", "n": "民意小", "a": "花蓮市" }, { "c": "0505", "n": "富國一小", "a": "花蓮市" },

			  // 吉安鄉
			  { "c": "0033", "n": "吉安林", "a": "吉安鄉" }, { "c": "0034", "n": "田浦", "a": "吉安鄉" }, { "c": "0035", "n": "南埔", "a": "吉安鄉" }, { "c": "0036", "n": "化仁", "a": "吉安鄉" },
			  { "c": "0037", "n": "廣榮", "a": "吉安鄉" }, { "c": "0038", "n": "宜昌", "a": "吉安鄉" }, { "c": "0039", "n": "慈安", "a": "吉安鄉" }, { "c": "0040", "n": "仁禮", "a": "吉安鄉" },
			  { "c": "0041", "n": "仁義", "a": "吉安鄉" }, { "c": "0042", "n": "宜安", "a": "吉安鄉" }, { "c": "0043", "n": "宜寧", "a": "吉安鄉" }, { "c": "0073", "n": "仁廉", "a": "吉安鄉" },
			  { "c": "0074", "n": "仁恥", "a": "吉安鄉" }, { "c": "0075", "n": "太昌", "a": "吉安鄉" }, { "c": "0076", "n": "慶豐", "a": "吉安鄉" }, { "c": "0077", "n": "福興", "a": "吉安鄉" },
			  { "c": "0078", "n": "稻香", "a": "吉安鄉" }, { "c": "0102", "n": "慈勝", "a": "吉安鄉" }, { "c": "0103", "n": "慈惠", "a": "吉安鄉" }, { "c": "0104", "n": "吉興", "a": "吉安鄉" },
			  { "c": "0105", "n": "稻園", "a": "吉安鄉" }, { "c": "0106", "n": "光華", "a": "吉安鄉" }, { "c": "0121", "n": "永安", "a": "吉安鄉" }, { "c": "0122", "n": "永興", "a": "吉安鄉" },
			  { "c": "0123", "n": "福吉", "a": "吉安鄉" }, { "c": "0124", "n": "福南", "a": "吉安鄉" }, { "c": "0125", "n": "華興", "a": "吉安鄉" }, { "c": "0126", "n": "南華", "a": "吉安鄉" },
			  { "c": "0127", "n": "草芬", "a": "吉安鄉" }, { "c": "0128", "n": "干城", "a": "吉安鄉" }, { "c": "0129", "n": "廣賢", "a": "吉安鄉" }, { "c": "0130", "n": "東昌", "a": "吉安鄉" },
			  { "c": "0131", "n": "海濱", "a": "吉安鄉" }, { "c": "0132", "n": "光中", "a": "吉安鄉" }, { "c": "0133", "n": "仁和", "a": "吉安鄉" }, { "c": "0134", "n": "仁愛", "a": "吉安鄉" },
			  { "c": "0135", "n": "光明", "a": "吉安鄉" }, { "c": "0136", "n": "光學", "a": "吉安鄉" }, { "c": "0137", "n": "光輝", "a": "吉安鄉" }, { "c": "0138", "n": "光英", "a": "吉安鄉" },
			  { "c": "0139", "n": "光華二小", "a": "吉安鄉" }, { "c": "0142", "n": "初音", "a": "吉安鄉" },

			  // 壽豐鄉
			  { "c": "0026", "n": "壽", "a": "壽豐鄉" }, { "c": "0027", "n": "豐田", "a": "壽豐鄉" }, { "c": "0028", "n": "志學", "a": "壽豐鄉" }, { "c": "0029", "n": "治平", "a": "壽豐鄉" },
			  { "c": "0030", "n": "月眉", "a": "壽豐鄉" }, { "c": "0031", "n": "水建", "a": "壽豐鄉" }, { "c": "0032", "n": "豐坪", "a": "壽豐鄉" }, { "c": "0044", "n": "壽豐", "a": "壽豐鄉" },
			  { "c": "0067", "n": "樹林", "a": "壽豐鄉" }, { "c": "0071", "n": "廣安", "a": "壽豐鄉" }, { "c": "0079", "n": "萬壽", "a": "壽豐鄉" }, { "c": "0080", "n": "萬壽二", "a": "壽豐鄉" },
			  { "c": "0116", "n": "萬壽一", "a": "壽豐鄉" }, { "c": "0117", "n": "光榮", "a": "壽豐鄉" }, { "c": "0118", "n": "共和", "a": "壽豐鄉" }, { "c": "0119", "n": "沼田", "a": "壽豐鄉" },
			  { "c": "0120", "n": "政明", "a": "壽豐鄉" }, { "c": "0140", "n": "三農", "a": "壽豐鄉" }, { "c": "0141", "n": "壽月", "a": "壽豐鄉" }, { "c": "0143", "n": "潭北", "a": "壽豐鄉" },
			  { "c": "0144", "n": "池南", "a": "壽豐鄉" }, { "c": "0145", "n": "荖溪", "a": "壽豐鄉" }, { "c": "0147", "n": "山嶺", "a": "壽豐鄉" }, { "c": "0161", "n": "鹽寮", "a": "壽豐鄉" },
			  { "c": "0167", "n": "溪口", "a": "壽豐鄉" }, { "c": "0168", "n": "米棧", "a": "壽豐鄉" }, { "c": "0170", "n": "鯉魚潭", "a": "壽豐鄉" }, { "c": "0171", "n": "溪南", "a": "壽豐鄉" },
			  { "c": "0180", "n": "萬富", "a": "壽豐鄉" }, { "c": "0181", "n": "潭南", "a": "壽豐鄉" }, { "c": "0182", "n": "壽山", "a": "壽豐鄉" }, { "c": "0183", "n": "志平", "a": "壽豐鄉" },
			  { "c": "0185", "n": "豐東", "a": "壽豐鄉" }, { "c": "0186", "n": "路內", "a": "壽豐鄉" }, { "c": "0187", "n": "東華", "a": "壽豐鄉" }, { "c": "0188", "n": "平和", "a": "壽豐鄉" },
			  { "c": "0189", "n": "吳全", "a": "壽豐鄉" }, { "c": "0452", "n": "米棧", "a": "壽豐鄉" }, { "c": "0465", "n": "壽農", "a": "壽豐鄉" }, { "c": "0497", "n": "豐山", "a": "壽豐鄉" },
			  { "c": "0500", "n": "豐裡", "a": "壽豐鄉" },

			  // 新城鄉
			  { "c": "0050", "n": "新城", "a": "新城鄉" }, { "c": "0051", "n": "北埔", "a": "新城鄉" }, { "c": "0052", "n": "加禮", "a": "新城鄉" }, { "c": "0053", "n": "平野", "a": "新城鄉" },
			  { "c": "0054", "n": "中正", "a": "新城鄉" }, { "c": "0055", "n": "嘉平", "a": "新城鄉" }, { "c": "0056", "n": "嘉新", "a": "新城鄉" }, { "c": "0057", "n": "嘉南", "a": "新城鄉" },
			  { "c": "0058", "n": "嘉北", "a": "新城鄉" }, { "c": "0059", "n": "佳林", "a": "新城鄉" }, { "c": "0060", "n": "佳東", "a": "新城鄉" }, { "c": "0061", "n": "天佑", "a": "新城鄉" },
			  { "c": "0062", "n": "興田", "a": "新城鄉" }, { "c": "0063", "n": "興海", "a": "新城鄉" }, { "c": "0064", "n": "順安", "a": "新城鄉" }, { "c": "0065", "n": "草林", "a": "新城鄉" },
			  { "c": "0066", "n": "新興", "a": "新城鄉" }, { "c": "0068", "n": "康樂", "a": "新城鄉" }, { "c": "0069", "n": "大漢", "a": "新城鄉" }, { "c": "0070", "n": "山廣", "a": "新城鄉" },
			  { "c": "0441", "n": "五十甲", "a": "新城鄉" }, { "c": "0442", "n": "永新", "a": "新城鄉" }, { "c": "0443", "n": "永吉", "a": "新城鄉" },

			  // 秀林鄉
			  { "c": "0190", "n": "秀林", "a": "秀林鄉" }, { "c": "0191", "n": "富世", "a": "秀林鄉" }, { "c": "0192", "n": "和平", "a": "秀林鄉" }, { "c": "0193", "n": "洛韶", "a": "秀林鄉" },
			  { "c": "0194", "n": "慈恩", "a": "秀林鄉" }, { "c": "0197", "n": "崇德", "a": "秀林鄉" }, { "c": "0198", "n": "卡來萬", "a": "秀林鄉" }, { "c": "0400", "n": "合歡", "a": "秀林鄉" },
			  { "c": "0401", "n": "三角錐", "a": "秀林鄉" }, { "c": "0402", "n": "三棧", "a": "秀林鄉" }, { "c": "0404", "n": "榕樹", "a": "秀林鄉" }, { "c": "0405", "n": "佳民", "a": "秀林鄉" },
			  { "c": "0407", "n": "銅門", "a": "秀林鄉" }, { "c": "0408", "n": "文蘭", "a": "秀林鄉" }, { "c": "0409", "n": "重光", "a": "秀林鄉" }, { "c": "0410", "n": "水源", "a": "秀林鄉" },
			  { "c": "0414", "n": "關原", "a": "秀林鄉" }, { "c": "0415", "n": "松雪樓", "a": "秀林鄉" }, { "c": "0422", "n": "牡丹岩", "a": "秀林鄉" }, { "c": "0423", "n": "哈崙", "a": "秀林鄉" },
			  { "c": "0424", "n": "木瓜", "a": "秀 poll 林鄉" }, { "c": "0425", "n": "研海", "a": "秀林鄉" }, { "c": "0427", "n": "燕子口", "a": "秀林鄉" }, { "c": "0432", "n": "民有", "a": "秀林鄉" },
			  { "c": "0436", "n": "上崇德", "a": "秀林鄉" }, { "c": "0437", "n": "下崇德", "a": "秀林鄉" }, { "c": "0473", "n": "杜錦", "a": "秀林鄉" }, { "c": "0474", "n": "長春", "a": "秀林鄉" },
			  { "c": "0475", "n": "塔山", "a": "秀林鄉" }, { "c": "0476", "n": "陶塞", "a": "秀林鄉" }, { "c": "0477", "n": "德布克", "a": "秀林鄉" }, { "c": "0478", "n": "龍溪", "a": "秀林鄉" },
			  { "c": "0482", "n": "卡來萬", "a": "秀林鄉" }, { "c": "0488", "n": "布拉旦", "a": "秀林鄉" }, { "c": "0489", "n": "加灣", "a": "秀林鄉" }, { "c": "0491", "n": "上水源", "a": "秀林鄉" },
			  { "c": "0492", "n": "下水源", "a": "秀林鄉" }, { "c": "0493", "n": "依柏合", "a": "秀林鄉" }, { "c": "0502", "n": "谷那", "a": "秀林鄉" },
            // 鳳林鎮
			  { "c": "0205", "n": "鳳林", "a": "鳳林鎮" }, { "c": "0213", "n": "林田", "a": "鳳林鎮" }, { "c": "0207", "n": "山興", "a": "鳳林鎮" }, { "c": "0208", "n": "萬里橋", "a": "鳳林鎮" },
			  { "c": "0209", "n": "榮東", "a": "鳳林鎮" }, { "c": "0210", "n": "榮花", "a": "鳳林鎮" }, { "c": "0211", "n": "榮發", "a": "鳳林鎮" }, { "c": "0225", "n": "鳳仁", "a": "鳳林鎮" },
			  { "c": "0226", "n": "鳳光", "a": "鳳林鎮" }, { "c": "0227", "n": "鳳明", "a": "鳳林鎮" }, { "c": "0228", "n": "榮開", "a": "鳳林鎮" }, { "c": "0229", "n": "榮昌", "a": "鳳林鎮" },
			  { "c": "0246", "n": "林榮", "a": "鳳林鎮" }, { "c": "0247", "n": "水車", "a": "鳳林鎮" }, { "c": "0248", "n": "北林", "a": "鳳林鎮" }, { "c": "0249", "n": "大榮", "a": "鳳林鎮" },
			  { "c": "0250", "n": "鳳信", "a": "鳳林鎮" }, { "c": "0251", "n": "南平", "a": "鳳林鎮" }, { "c": "0252", "n": "鳳義", "a": "鳳林鎮" }, { "c": "0253", "n": "鳳凰", "a": "鳳林鎮" },
			  { "c": "0278", "n": "綜開", "a": "鳳林鎮" }, { "c": "0283", "n": "鳳榮", "a": "鳳林鎮" }, { "c": "0284", "n": "森榮", "a": "鳳林鎮" }, { "c": "0285", "n": "長橋", "a": "鳳林鎮" },
			  { "c": "0286", "n": "中心埔", "a": "鳳林鎮" }, { "c": "0292", "n": "中興", "a": "鳳林鎮" }, { "c": "0293", "n": "箭瑛", "a": "鳳林鎮" }, { "c": "0907", "n": "山崎", "a": "鳳林鎮" },
			  { "c": "0908", "n": "兆豐", "a": "鳳林鎮" }, { "c": "0917", "n": "中原", "a": "鳳林鎮" },

			  // 光復鄉
			  { "c": "0200", "n": "光復", "a": "光復鄉" }, { "c": "0201", "n": "大安", "a": "光復鄉" }, { "c": "0202", "n": "大平", "a": "光復鄉" }, { "c": "0203", "n": "大富", "a": "光復鄉" },
			  { "c": "0204", "n": "富田", "a": "光復鄉" }, { "c": "0239", "n": "東富", "a": "光復鄉" }, { "c": "0240", "n": "太巴塱", "a": "光復鄉" }, { "c": "0241", "n": "溪州", "a": "光復鄉" },
			  { "c": "0242", "n": "達莫", "a": "光復鄉" }, { "c": "0243", "n": "砂荖", "a": "光復鄉" }, { "c": "0244", "n": "西富", "a": "光復鄉" }, { "c": "0245", "n": "馬佛", "a": "光復鄉" },
			  { "c": "0277", "n": "大馬", "a": "光復鄉" }, { "c": "0280", "n": "水廣", "a": "光復鄉" }, { "c": "0281", "n": "新莊", "a": "光復鄉" }, { "c": "0282", "n": "大全", "a": "光復鄉" },
			  { "c": "0287", "n": "大豐", "a": "光復鄉" }, { "c": "0288", "n": "大和", "a": "光復鄉" }, { "c": "0289", "n": "大興", "a": "光復鄉" }, { "c": "0290", "n": "富豐", "a": "光復鄉" },
			  { "c": "0294", "n": "加里洞", "a": "光復鄉" }, { "c": "0299", "n": "大農", "a": "光復鄉" }, { "c": "0900", "n": "加禮灣", "a": "光復鄉" }, { "c": "0901", "n": "管真", "a": "光復鄉" },
			  { "c": "0909", "n": "馬山", "a": "光復鄉" }, { "c": "0911", "n": "麗太", "a": "光復鄉" }, { "c": "0912", "n": "利哈岸", "a": "光復鄉" }, { "c": "0919", "n": "大安一小", "a": "光復鄉" },

			  // 豐濱鄉
			  { "c": "0212", "n": "豐濱", "a": "豐濱鄉" }, { "c": "0213", "n": "新社", "a": "豐濱鄉" }, { "c": "0214", "n": "臨海", "a": "豐濱鄉" }, { "c": "0215", "n": "海濱", "a": "豐濱鄉" },
			  { "c": "0216", "n": "石梯", "a": "豐濱鄉" }, { "c": "0217", "n": "大港口", "a": "豐濱鄉" }, { "c": "0218", "n": "靜浦", "a": "豐濱鄉" }, { "c": "0230", "n": "浴海", "a": "豐濱鄉" },
			  { "c": "0231", "n": "新豐", "a": "豐濱鄉" }, { "c": "0232", "n": "東興", "a": "豐濱鄉" }, { "c": "0233", "n": "豐義", "a": "豐濱鄉" }, { "c": "0234", "n": "豐仁", "a": "豐濱鄉" },
			  { "c": "0235", "n": "石門", "a": "豐濱鄉" }, { "c": "0236", "n": "秀山", "a": "豐濱鄉" }, { "c": "0237", "n": "長虹", "a": "豐濱鄉" }, { "c": "0238", "n": "三富", "a": "豐濱鄉" },
			  { "c": "0273", "n": "八里灣", "a": "豐濱鄉" }, { "c": "0913", "n": "秀朗", "a": "豐濱鄉" }, { "c": "0915", "n": "宮下", "a": "豐濱鄉" }, { "c": "0916", "n": "磯崎", "a": "豐濱鄉" },
			  { "c": "0918", "n": "丁仔漏", "a": "豐濱鄉" }, { "c": "0921", "n": "石梯坪", "a": "豐濱鄉" }, { "c": "0924", "n": "馬固達愛", "a": "豐濱鄉" }, { "c": "0927", "n": "貓公", "a": "豐濱鄉" },

			  // 萬榮鄉
			  { "c": "0219", "n": "萬榮", "a": "萬榮鄉" }, { "c": "0220", "n": "西林", "a": "萬榮鄉" }, { "c": "0221", "n": "見晴", "a": "萬榮鄉" }, { "c": "0222", "n": "明利", "a": "萬榮鄉" },
			  { "c": "0223", "n": "馬遠", "a": "萬榮鄉" }, { "c": "0224", "n": "紅葉", "a": "萬榮鄉" }, { "c": "0254", "n": "富士岳", "a": "萬榮鄉" }, { "c": "0255", "n": "二子山", "a": "萬榮鄉" },
			  { "c": "0256", "n": "安山", "a": "萬榮鄉" }, { "c": "0257", "n": "瞭望台", "a": "萬榮鄉" }, { "c": "0258", "n": "清溪", "a": "萬榮鄉" }, { "c": "0259", "n": "萬安", "a": "萬榮鄉" },
			  { "c": "0260", "n": "西晴", "a": "萬榮鄉" }, { "c": "0261", "n": "安東", "a": "萬榮鄉" }, { "c": "0262", "n": "高嶺", "a": "萬榮鄉" }, { "c": "0263", "n": "大觀", "a": "萬榮鄉" },
			  { "c": "0264", "n": "王武塔", "a": "萬榮鄉" }, { "c": "0265", "n": "馬太鞍", "a": "萬榮鄉" }, { "c": "0266", "n": "加農溪", "a": "萬榮鄉" }, { "c": "0267", "n": "鞍南", "a": "萬榮鄉" },
			  { "c": "0268", "n": "鞍溪", "a": "萬榮鄉" }, { "c": "0269", "n": "丹大山", "a": "萬榮鄉" }, { "c": "0270", "n": "大石公", "a": "萬榮鄉" }, { "c": "0271", "n": "望溪", "a": "萬榮鄉" },
			  { "c": "0272", "n": "嶺南", "a": "萬榮鄉" }, { "c": "0274", "n": "拔子", "a": "萬榮鄉" }, { "c": "0275", "n": "虎頭山", "a": "萬榮鄉" }, { "c": "0276", "n": "迪佳山", "a": "萬榮鄉" },
			  { "c": "0279", "n": "可汗", "a": "萬榮鄉" }, { "c": "0291", "n": "西寶", "a": "萬榮鄉" }, { "c": "0296", "n": "虎林", "a": "萬榮鄉" }, { "c": "0902", "n": "支亞干", "a": "萬榮鄉" },
			  { "c": "0903", "n": "新白楊", "a": "萬榮鄉" }, { "c": "0904", "n": "萬寶", "a": "萬榮鄉" }, { "c": "0905", "n": "萬利", "a": "萬榮鄉" }, { "c": "0906", "n": "古努安", "a": "萬榮鄉" },
			  { "c": "0914", "n": "悅付南", "a": "萬榮鄉" }, { "c": "0923", "n": "里烈可", "a": "萬榮鄉" }, { "c": "0925", "n": "新紅葉", "a": "萬榮鄉" }, { "c": "0926", "n": "內溫泉", "a": "萬榮鄉" },
			  // 玉里鎮
			  { "c": "0300", "n": "三民", "a": "玉里鎮" }, { "c": "0301", "n": "大禹", "a": "玉里鎮" }, { "c": "0302", "n": "玉昌", "a": "玉里鎮" }, { "c": "0303", "n": "玉璞", "a": "玉里鎮" },
			  { "c": "0304", "n": "玉城", "a": "玉里鎮" }, { "c": "0305", "n": "玉泉", "a": "玉里鎮" }, { "c": "0306", "n": "玉里", "a": "玉里鎮" }, { "c": "0307", "n": "春日", "a": "玉里鎮" },
			  { "c": "0308", "n": "觀音山", "a": "玉里鎮" }, { "c": "0309", "n": "樂合", "a": "玉里鎮" }, { "c": "0310", "n": "長良", "a": "玉里鎮" }, { "c": "0311", "n": "永安", "a": "玉里鎮" },
			  { "c": "0339", "n": "源城", "a": "玉里鎮" }, { "c": "0345", "n": "三義", "a": "玉里鎮" }, { "c": "0346", "n": "三義一小", "a": "玉里鎮" }, { "c": "0347", "n": "三義二小", "a": "玉里鎮" },
			  { "c": "0348", "n": "東豐", "a": "玉里鎮" }, { "c": "0349", "n": "禹東", "a": "玉里鎮" }, { "c": "0364", "n": "禹東一小", "a": "玉里鎮" }, { "c": "0365", "n": "松浦", "a": "玉里鎮" },
			  { "c": "0366", "n": "禹北", "a": "玉里鎮" }, { "c": "0368", "n": "東豐小", "a": "玉里鎮" }, { "c": "0386", "n": "大嵙山", "a": "玉里鎮" }, { "c": "0399", "n": "玉東", "a": "玉里鎮" },
			  { "c": "0700", "n": "酸柑", "a": "玉里鎮" }, { "c": "0701", "n": "禹中", "a": "玉里鎮" }, { "c": "0703", "n": "禹西", "a": "玉里鎮" }, { "c": "0706", "n": "民北", "a": "玉里鎮" },
			  { "c": "0709", "n": "民南", "a": "玉里鎮" }, { "c": "0710", "n": "永良", "a": "玉里鎮" }, { "c": "0711", "n": "船山", "a": "玉里鎮" }, { "c": "0712", "n": "馬太林山", "a": "玉里鎮" },
			  { "c": "0713", "n": "赤科山", "a": "玉里鎮" }, { "c": "0714", "n": "石崗山", "a": "玉里鎮" }, { "c": "0715", "n": "安通山", "a": "玉里鎮" }, { "c": "0744", "n": "德武", "a": "玉里鎮" },
			  { "c": "0745", "n": "神農", "a": "玉里鎮" }, { "c": "0746", "n": "泰林", "a": "玉里鎮" }, { "c": "0747", "n": "高寮", "a": "玉里鎮" }, { "c": "0752", "n": "玉璞一小", "a": "玉里鎮" },
			  { "c": "0753", "n": "玉璞二小", "a": "玉里鎮" }, { "c": "0754", "n": "麻汝", "a": "玉里鎮" }, { "c": "0755", "n": "滿自然", "a": "玉里鎮" }, { "c": "0756", "n": "東豐南", "a": "玉里鎮" },
			  { "c": "0757", "n": "哈拉灣", "a": "玉里鎮" }, { "c": "0758", "n": "安坐", "a": "玉里鎮" }, { "c": "0759", "n": "宮前", "a": "玉里鎮" }, { "c": "0762", "n": "新大禹", "a": "玉里鎮" },
			  { "c": "0763", "n": "神社", "a": "玉里鎮" }, { "c": "0764", "n": "水源", "a": "玉里鎮" }, { "c": "0765", "n": "舊田", "a": "玉里鎮" }, { "c": "0766", "n": "高寮南", "a": "玉里鎮" },
			  { "c": "0772", "n": "玉城一小", "a": "玉里鎮" }, { "c": "0790", "n": "玉城二小", "a": "玉里鎮" }, { "c": "0791", "n": "玉璞三小", "a": "玉里鎮" }, { "c": "0795", "n": "末廣", "a": "玉里鎮" },
			  { "c": "0796", "n": "玉昌一小", "a": "玉里鎮" }, { "c": "0797", "n": "玉昌二小", "a": "玉里鎮" }, { "c": "0798", "n": "信農", "a": "玉里鎮" },

			  // 瑞穗鄉
			  { "c": "0312", "n": "富源", "a": "瑞穗鄉" }, { "c": "0313", "n": "富源可汗小", "a": "瑞穗鄉" }, { "c": "0314", "n": "富興", "a": "瑞穗鄉" }, { "c": "0315", "n": "瑞穗", "a": "瑞穗鄉" },
			  { "c": "0316", "n": "鶴岡", "a": "瑞穗鄉" }, { "c": "0317", "n": "舞鶴", "a": "瑞穗鄉" }, { "c": "0318", "n": "奇美", "a": "瑞穗鄉" }, { "c": "0333", "n": "瑞燕", "a": "瑞穗鄉" },
			  { "c": "0334", "n": "瑞美", "a": "瑞穗鄉" }, { "c": "0335", "n": "瑞泉", "a": "瑞穗鄉" }, { "c": "0336", "n": "瑞新", "a": "瑞穗鄉" }, { "c": "0337", "n": "瑞良", "a": "瑞穗鄉" },
			  { "c": "0338", "n": "瑞強", "a": "瑞穗鄉" }, { "c": "0360", "n": "北岡", "a": "瑞穗鄉" }, { "c": "0361", "n": "南岡", "a": "瑞穗鄉" }, { "c": "0362", "n": "掃叭頂", "a": "瑞穗鄉" },
			  { "c": "0367", "n": "烏漏", "a": "瑞穗鄉" }, { "c": "0387", "n": "大奇山", "a": "瑞穗鄉" }, { "c": "0704", "n": "源南", "a": "瑞穗鄉" }, { "c": "0705", "n": "源北", "a": "瑞穗鄉" },
			  { "c": "0707", "n": "興南", "a": "瑞穗鄉" }, { "c": "0708", "n": "興北", "a": "瑞穗鄉" }, { "c": "0716", "n": "加萊坑山", "a": "瑞穗鄉" }, { "c": "0717", "n": "新瑞山", "a": "瑞穗鄉" },
			  { "c": "0718", "n": "奇密山", "a": "瑞穗鄉" }, { "c": "0719", "n": "里牙津山", "a": "瑞穗鄉" }, { "c": "0748", "n": "瑞北", "a": "瑞穗鄉" }, { "c": "0749", "n": "瑞祥", "a": "瑞穗鄉" },
			  { "c": "0750", "n": "溫泉", "a": "瑞穗鄉" }, { "c": "0751", "n": "青蓮", "a": "瑞穗鄉" }, { "c": "0760", "n": "舞鶴東", "a": "瑞穗鄉" }, { "c": "0761", "n": "新舞鶴", "a": "瑞穗鄉" },
			  { "c": "0784", "n": "大肚華", "a": "瑞穗鄉" }, { "c": "0785", "n": "梧繞", "a": "瑞穗鄉" }, { "c": "0786", "n": "谷優", "a": "瑞穗鄉" }, { "c": "0787", "n": "屋拉力", "a": "瑞穗鄉" },
			  { "c": "0788", "n": "青山", "a": "瑞穗鄉" }, { "c": "0789", "n": "下奇美", "a": "瑞穗鄉" }, { "c": "0792", "n": "上奇美", "a": "瑞穗鄉" }, { "c": "0793", "n": "過河", "a": "瑞穗鄉" },
			  { "c": "0794", "n": "猴子山", "a": "瑞穗鄉" },

			  // 富里鄉
			  { "c": "0319", "n": "大里", "a": "富里鄉" }, { "c": "0320", "n": "東竹", "a": "富里鄉" }, { "c": "0321", "n": "富里", "a": "富里鄉" }, { "c": "0322", "n": "堺", "a": "富里鄉" },
			  { "c": "0340", "n": "明里", "a": "富里鄉" }, { "c": "0341", "n": "石牌", "a": "富里鄉" }, { "c": "0342", "n": "中興", "a": "富里鄉" }, { "c": "0343", "n": "中平", "a": "富里鄉" },
			  { "c": "0344", "n": "富安", "a": "富里鄉" }, { "c": "0350", "n": "安通", "a": "富里鄉" }, { "c": "0351", "n": "富農", "a": "富里鄉" }, { "c": "0352", "n": "吳江", "a": "富里鄉" },
			  { "c": "0353", "n": "大庄", "a": "富里鄉" }, { "c": "0354", "n": "東里", "a": "富里鄉" }, { "c": "0355", "n": "農場", "a": "富里鄉" }, { "c": "0356", "n": "萬寧", "a": "富里鄉" },
			  { "c": "0357", "n": "學園", "a": "富里鄉" }, { "c": "0358", "n": "新興", "a": "富里鄉" }, { "c": "0359", "n": "竹田", "a": "富里鄉" }, { "c": "0363", "n": "學田", "a": "富里鄉" },
			  { "c": "0369", "n": "永豐", "a": "富里鄉" }, { "c": "0702", "n": "羅山", "a": "富里鄉" }, { "c": "0720", "n": "富長", "a": "富里鄉" }, { "c": "0726", "n": "富田", "a": "富里鄉" },
			  { "c": "0727", "n": "大莊越山", "a": "富里鄉" }, { "c": "0728", "n": "成廣澳山", "a": "富里鄉" }, { "c": "0729", "n": "安土堀山", "a": "富里鄉" }, { "c": "0730", "n": "四維", "a": "富里鄉" },
			  { "c": "0731", "n": "麻荖漏山", "a": "富里鄉" }, { "c": "0732", "n": "豐南", "a": "富里鄉" }, { "c": "0767", "n": "馬里旺", "a": "富里鄉" }, { "c": "0768", "n": "富南", "a": "富里鄉" },
			  { "c": "0769", "n": "鱉溪", "a": "富里鄉" }, { "c": "0770", "n": "富山", "a": "富里鄉" }, { "c": "0771", "n": "吉拉米代", "a": "富里鄉" }, { "c": "0773", "n": "泥火山", "a": "富里鄉" },
			  { "c": "0774", "n": "後湖", "a": "富里鄉" }, { "c": "0775", "n": "富豐", "a": "富里鄉" }, { "c": "0776", "n": "蚊子洞", "a": "富里鄉" }, { "c": "0777", "n": "木瓜山", "a": "富里鄉" },
			  { "c": "0778", "n": "福岡", "a": "富里鄉" }, { "c": "0779", "n": "新莊", "a": "富里鄉" }, { "c": "0780", "n": "溪埔", "a": "富里鄉" }, { "c": "0781", "n": "東寧", "a": "富里鄉" },
			  { "c": "0782", "n": "埔頭", "a": "富里鄉" }, { "c": "0783", "n": "六十石山", "a": "富里鄉" },

			  // 卓溪鄉
			  { "c": "0323", "n": "崙山", "a": "卓溪鄉" }, { "c": "0324", "n": "立山", "a": "卓溪鄉" }, { "c": "0325", "n": "山里", "a": "卓溪鄉" }, { "c": "0326", "n": "太平", "a": "卓溪鄉" },
			  { "c": "0327", "n": "卓溪", "a": "卓溪鄉" }, { "c": "0328", "n": "卓樂", "a": "卓溪鄉" }, { "c": "0329", "n": "清水", "a": "卓溪鄉" }, { "c": "0330", "n": "古風", "a": "卓溪鄉" },
			  { "c": "0331", "n": "石平", "a": "卓溪鄉" }, { "c": "0332", "n": "新生", "a": "卓溪鄉" }, { "c": "0370", "n": "鹿鳴", "a": "卓溪鄉" }, { "c": "0371", "n": "塔洛米", "a": "卓溪鄉" },
			  { "c": "0372", "n": "喀西帕南山", "a": "卓溪鄉" }, { "c": "0373", "n": "馬西桑", "a": "卓溪鄉" }, { "c": "0374", "n": "馬霍拉斯", "a": "卓溪鄉" }, { "c": "0375", "n": "米亞桑", "a": "卓溪鄉" },
			  { "c": "0376", "n": "大水窟", "a": "卓溪鄉" }, { "c": "0377", "n": "大分", "a": "卓溪鄉" }, { "c": "0378", "n": "南雙頭山", "a": "卓溪鄉" }, { "c": "0379", "n": "三叉山", "a": "卓溪鄉" },
			  { "c": "0380", "n": "瓦拉米", "a": "卓溪鄉" }, { "c": "0381", "n": "山風", "a": "卓溪鄉" }, { "c": "0382", "n": "腦寮", "a": "卓溪鄉" }, { "c": "0383", "n": "班喀", "a": "卓溪鄉" },
			  { "c": "0384", "n": "布拉克桑山", "a": "卓溪鄉" }, { "c": "0385", "n": "龍泉", "a": "卓溪鄉" }, { "c": "0388", "n": "江布南山", "a": "卓溪鄉" }, { "c": "0389", "n": "生保", "a": "卓溪鄉" },
			  { "c": "0390", "n": "玉林橋", "a": "卓溪鄉" }, { "c": "0391", "n": "丹大山", "a": "卓溪鄉" }, { "c": "0392", "n": "無雙", "a": "卓溪鄉" }, { "c": "0393", "n": "豐坪溪", "a": "卓溪鄉" },
			  { "c": "0394", "n": "尼克列", "a": "卓溪鄉" }, { "c": "0395", "n": "草古安山", "a": "卓溪鄉" }, { "c": "0396", "n": "苗圃", "a": "卓溪鄉" }, { "c": "0397", "n": "他尾羅山", "a": "卓溪鄉" },
			  { "c": "0398", "n": "新康山", "a": "卓溪鄉" }, { "c": "0721", "n": "虎山", "a": "卓溪鄉" }, { "c": "0722", "n": "馬立雲山", "a": "卓溪鄉" }, { "c": "0723", "n": "迪佳山", "a": "卓溪鄉" },
			  { "c": "0724", "n": "和留山", "a": "卓溪鄉" }, { "c": "0725", "n": "新吞山", "a": "卓溪鄉" }, { "c": "0733", "n": "南安", "a": "卓溪鄉" }, { "c": "0734", "n": "大里仙山", "a": "卓溪鄉" },
			  { "c": "0735", "n": "拉庫拉庫", "a": "卓溪鄉" }, { "c": "0736", "n": "巴瓦薩庫", "a": "卓溪鄉" }, { "c": "0737", "n": "舞樂山", "a": "卓溪鄉" }, { "c": "0738", "n": "三興", "a": "卓溪鄉" },
			  { "c": "0739", "n": "大福", "a": "卓溪鄉" }, { "c": "0740", "n": "白端", "a": "卓溪鄉" }, { "c": "0741", "n": "崙天", "a": "卓溪鄉" }, { "c": "0742", "n": "秀巒山", "a": "卓溪鄉" },
			  { "c": "0743", "n": "石壁山", "a": "卓溪鄉" }, { "c": "0799", "n": "崙布山", "a": "卓溪鄉" }, { "c": "0800", "n": "塔菲拉", "a": "卓溪鄉" }, { "c": "0801", "n": "法老", "a": "卓溪鄉" },
			  { "c": "0802", "n": "督林", "a": "卓溪鄉" }, { "c": "0803", "n": "新立山", "a": "卓溪鄉" }
        ];

        const searchInput = document.getElementById('searchInput');
        const resultsContainer = document.getElementById('resultsContainer');
        const defaultContainer = document.getElementById('defaultContainer');
        const suggestionBox = document.getElementById('suggestionBox');
        const suggestionText = document.getElementById('suggestionText');
        const officeListContainer = document.getElementById('officeList');
        const emptyStateIcon = document.getElementById('emptyStateIcon');

        window.addEventListener('DOMContentLoaded', () => {
            renderOfficeList();
            lucide.createIcons();
            searchInput.addEventListener('input', handleSearch);
        });

        function handleSearch(e) {
            const rawTerm = e.target.value;
            const term = rawTerm.trim().replace('台', '臺');
            
            if (!term) {
                showDefaultView();
                return;
            }

            let results = [];
            const isDigitSearch = /^\d+$/.test(term);

            // 1. 行政區匹配
            offices.filter(o => o.areas.some(a => a.includes(term))).forEach(o => {
                const matchedArea = o.areas.find(a => a.includes(term));
                results.push({
                    office: o,
                    matchType: 'area',
                    matchName: matchedArea
                });
            });

            // 2. 地段/代碼匹配
            sectionDatabase.filter(s => isDigitSearch ? s.c.includes(term) : (s.n.includes(term) || (s.n + '段').includes(term)))
                .forEach(match => {
                    const office = offices.find(o => o.areas.includes(match.a));
                    if (office && !results.some(r => r.code === match.c)) {
                        results.push({
                            office: office,
                            matchType: 'section',
                            matchName: match.n + '段',
                            code: match.c,
                            relatedArea: match.a
                        });
                    }
                });

            // 3. 排序
            if (isDigitSearch) {
                results.sort((a, b) => (a.code || '').localeCompare(b.code || ''));
            } else {
                results.sort((a, b) => a.matchName.localeCompare(b.matchName, 'zh-Hant-TW'));
            }

            if (results.length > 0) {
                renderResults(results, isDigitSearch);
            } else {
                showDefaultView();
                showSuggestion('查無結果。請嘗試輸入正確的鄉鎮名或四位數地段代碼。');
            }
        }

        function setSearch(val) {
            searchInput.value = val;
            handleSearch({ target: { value: val } });
            // 自動捲動到結果處
            window.scrollTo({ top: searchInput.offsetTop - 20, behavior: 'smooth' });
        }

        function renderResults(results, isDigitSearch) {
            resultsContainer.classList.remove('hidden');
            defaultContainer.classList.add('hidden');
            resultsContainer.innerHTML = '';

            const countText = isDigitSearch ? `找到 <strong>${results.length}</strong> 筆代碼包含「${searchInput.value}」的地段。` : `找到 <strong>${results.length}</strong> 筆相符資料。`;
            resultsContainer.innerHTML = `
                <div class="bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg mb-6 shadow-sm">
                    <div class="flex items-center">
                        <i data-lucide="info" class="h-5 w-5 text-yellow-600 mr-2 shrink-0"></i>
                        <p class="text-sm text-yellow-700">${countText}</p>
                    </div>
                </div>
            `;

            results.forEach(result => {
                const card = document.createElement('div');
                card.className = "shadow-lg rounded-2xl overflow-hidden bg-white mb-6 border border-gray-100 transition-all hover:shadow-xl";
                
                let matchContent = '';
                if (result.matchType === 'area') {
                    matchContent = `您查詢的行政區為 <strong class="text-lg text-teal-800">${result.matchName}</strong>`;
                } else {
                    matchContent = `地段：<strong class="text-xl text-teal-800">${result.matchName}</strong> <br class="md:hidden"> <span class="hidden md:inline mx-2 text-gray-300">|</span> 代碼：<span class="bg-orange-100 text-orange-700 px-2 rounded font-mono font-bold">${result.code}</span> <br> 位於：<span class="text-gray-600 font-medium">${result.relatedArea}</span>`;
                }

                const areasHtml = result.office.areas.map(area => {
                    const isHighlight = area === result.matchName || area === result.relatedArea;
                    const classes = isHighlight ? 'bg-yellow-200 text-yellow-800 font-bold ring-1 ring-yellow-300' : 'text-gray-500 bg-gray-100';
                    return `<span class="text-xs px-2.5 py-1 rounded-md ${classes}">${area}</span>`;
                }).join('');

                card.innerHTML = `
                    <div class="p-5 text-white ${result.office.color} flex justify-between items-center">
                        <div>
                            <span class="text-[10px] uppercase tracking-[0.2em] opacity-80 font-bold">管轄單位</span>
                            <h2 class="text-xl md:text-2xl font-bold">${result.office.name}</h2>
                        </div>
                        <i data-lucide="landmark" class="w-8 h-8 opacity-40"></i>
                    </div>
                    
                    <div class="p-5 md:p-8">
                        <div class="mb-6 ${result.office.lightColor} border-l-4 ${result.office.borderColor} p-4 rounded-r-xl shadow-inner">
                            <p class="text-sm md:text-base text-gray-800 leading-relaxed">${matchContent}</p>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                            <div class="flex items-start">
                                <div class="bg-gray-100 p-2 rounded-lg mr-4">
                                    <i data-lucide="map-pin" class="w-5 h-5 text-gray-500"></i>
                                </div>
                                <div>
                                    <p class="text-[10px] text-gray-400 font-bold uppercase mb-0.5">服務地址</p>
                                    <p class="text-sm text-gray-800 font-medium">${result.office.address}</p>
                                </div>
                            </div>
                            <div class="flex items-start">
                                <div class="bg-gray-100 p-2 rounded-lg mr-4">
                                    <i data-lucide="phone" class="w-5 h-5 text-gray-500"></i>
                                </div>
                                <div>
                                    <p class="text-[10px] text-gray-400 font-bold uppercase mb-0.5">聯絡電話</p>
                                    <a href="tel:${result.office.phone}" class="text-teal-600 font-bold hover:underline text-lg decoration-2 underline-offset-4">${result.office.phone}</a>
                                </div>
                            </div>
                        </div>

                        <div class="mb-8">
                            <div class="flex items-center mb-3">
                                <i data-lucide="layers" class="w-4 h-4 text-gray-400 mr-2"></i>
                                <p class="text-[10px] text-gray-400 font-bold uppercase">該所完整轄區</p>
                            </div>
                            <div class="flex flex-wrap gap-2">${areasHtml}</div>
                        </div>

                        <div class="flex flex-col sm:flex-row gap-3">
                            <a href="${result.office.mapLink}" target="_blank" class="flex-1 bg-teal-600 text-white py-3.5 px-4 rounded-xl text-center font-bold hover:bg-teal-700 transition flex items-center justify-center gap-2 active:scale-95">
                                <i data-lucide="navigation" class="w-4 h-4"></i> 導航前往
                            </a>
                            <a href="${result.office.website}" target="_blank" class="flex-1 bg-white border-2 border-gray-200 text-gray-700 py-3.5 px-4 rounded-xl text-center font-bold hover:border-gray-300 hover:bg-gray-50 transition flex items-center justify-center gap-2 active:scale-95">
                                <i data-lucide="external-link" class="w-4 h-4"></i> 官方網站
                            </a>
                        </div>
                    </div>
                `;
                resultsContainer.appendChild(card);
            });
            lucide.createIcons();
        }

        function showDefaultView() {
            resultsContainer.classList.add('hidden');
            defaultContainer.classList.remove('hidden');
            suggestionBox.classList.add('hidden');
            emptyStateIcon.classList.remove('hidden');
        }

        function showSuggestion(msg) {
            suggestionText.textContent = msg;
            suggestionBox.classList.remove('hidden');
            emptyStateIcon.classList.add('hidden');
        }

        function renderOfficeList() {
            officeListContainer.innerHTML = offices.map(o => `
                <div class="bg-white p-5 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition">
                    <div class="text-[10px] font-black px-2 py-1 text-white rounded-md w-fit mb-3 ${o.color}">
                        ${o.name}
                    </div>
                    <div class="flex flex-wrap gap-1.5">
                        ${o.areas.map(area => `
                            <span class="text-xs bg-gray-50 text-gray-600 px-2 py-1 rounded border border-gray-100">${area}</span>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        }
    </script>
</body>
</html>
